Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Loaded dataset with 87999 training examples
Map:   0%|          | 0/87999 [00:00<?, ? examples/s]Map:   1%|          | 1000/87999 [00:00<00:27, 3158.17 examples/s]Map:   2%|▏         | 2000/87999 [00:00<00:25, 3309.18 examples/s]Map:   3%|▎         | 3000/87999 [00:00<00:25, 3396.51 examples/s]Map:   5%|▍         | 4000/87999 [00:01<00:24, 3435.59 examples/s]Map:   6%|▌         | 5000/87999 [00:01<00:24, 3422.56 examples/s]Map:   7%|▋         | 6000/87999 [00:01<00:23, 3459.46 examples/s]Map:   8%|▊         | 7000/87999 [00:02<00:23, 3459.62 examples/s]Map:   9%|▉         | 8000/87999 [00:02<00:23, 3466.53 examples/s]Map:  10%|█         | 9000/87999 [00:02<00:22, 3450.17 examples/s]Map:  11%|█▏        | 10000/87999 [00:02<00:22, 3461.26 examples/s]Map:  13%|█▎        | 11000/87999 [00:03<00:22, 3453.09 examples/s]Map:  14%|█▎        | 12000/87999 [00:03<00:22, 3440.36 examples/s]Map:  15%|█▍        | 13000/87999 [00:03<00:21, 3450.14 examples/s]Map:  16%|█▌        | 14000/87999 [00:04<00:21, 3436.07 examples/s]Map:  17%|█▋        | 15000/87999 [00:04<00:23, 3060.71 examples/s]Map:  18%|█▊        | 16000/87999 [00:04<00:22, 3144.05 examples/s]Map:  19%|█▉        | 17000/87999 [00:05<00:22, 3221.16 examples/s]Map:  20%|██        | 18000/87999 [00:05<00:21, 3283.72 examples/s]Map:  22%|██▏       | 19000/87999 [00:05<00:20, 3333.74 examples/s]Map:  23%|██▎       | 20000/87999 [00:05<00:20, 3369.89 examples/s]Map:  24%|██▍       | 21000/87999 [00:06<00:19, 3363.67 examples/s]Map:  25%|██▌       | 22000/87999 [00:06<00:19, 3337.13 examples/s]Map:  26%|██▌       | 23000/87999 [00:06<00:19, 3331.88 examples/s]Map:  27%|██▋       | 24000/87999 [00:07<00:19, 3359.14 examples/s]Map:  28%|██▊       | 25000/87999 [00:07<00:18, 3387.55 examples/s]Map:  30%|██▉       | 26000/87999 [00:07<00:18, 3413.20 examples/s]Map:  31%|███       | 27000/87999 [00:08<00:17, 3439.01 examples/s]Map:  32%|███▏      | 28000/87999 [00:08<00:17, 3447.02 examples/s]Map:  33%|███▎      | 29000/87999 [00:08<00:17, 3436.04 examples/s]Map:  34%|███▍      | 30000/87999 [00:08<00:16, 3449.46 examples/s]Map:  35%|███▌      | 31000/87999 [00:09<00:16, 3447.94 examples/s]Map:  36%|███▋      | 32000/87999 [00:09<00:16, 3455.84 examples/s]Map:  38%|███▊      | 33000/87999 [00:09<00:15, 3471.17 examples/s]Map:  39%|███▊      | 34000/87999 [00:10<00:15, 3483.79 examples/s]Map:  40%|███▉      | 35000/87999 [00:10<00:15, 3479.91 examples/s]Map:  41%|████      | 36000/87999 [00:10<00:14, 3492.78 examples/s]Map:  42%|████▏     | 37000/87999 [00:10<00:14, 3480.72 examples/s]Map:  43%|████▎     | 38000/87999 [00:11<00:14, 3472.55 examples/s]Map:  44%|████▍     | 39000/87999 [00:11<00:14, 3475.90 examples/s]Map:  45%|████▌     | 40000/87999 [00:11<00:13, 3485.21 examples/s]Map:  47%|████▋     | 41000/87999 [00:12<00:13, 3470.04 examples/s]Map:  48%|████▊     | 42000/87999 [00:12<00:13, 3486.96 examples/s]Map:  49%|████▉     | 43000/87999 [00:12<00:12, 3489.21 examples/s]Map:  50%|█████     | 44000/87999 [00:12<00:12, 3459.56 examples/s]Map:  51%|█████     | 45000/87999 [00:13<00:12, 3486.48 examples/s]Map:  52%|█████▏    | 46000/87999 [00:13<00:12, 3485.27 examples/s]Map:  53%|█████▎    | 47000/87999 [00:13<00:11, 3473.45 examples/s]Map:  55%|█████▍    | 48000/87999 [00:14<00:11, 3478.93 examples/s]Map:  56%|█████▌    | 49000/87999 [00:14<00:12, 3101.70 examples/s]Map:  57%|█████▋    | 50000/87999 [00:14<00:11, 3211.19 examples/s]Map:  58%|█████▊    | 51000/87999 [00:15<00:11, 3269.97 examples/s]Map:  59%|█████▉    | 52000/87999 [00:15<00:10, 3340.38 examples/s]Map:  60%|██████    | 53000/87999 [00:15<00:10, 3361.74 examples/s]Map:  61%|██████▏   | 54000/87999 [00:15<00:10, 3398.38 examples/s]Map:  63%|██████▎   | 55000/87999 [00:16<00:09, 3429.93 examples/s]Map:  64%|██████▎   | 56000/87999 [00:16<00:09, 3448.13 examples/s]Map:  65%|██████▍   | 57000/87999 [00:16<00:08, 3444.54 examples/s]Map:  66%|██████▌   | 58000/87999 [00:17<00:08, 3440.77 examples/s]Map:  67%|██████▋   | 59000/87999 [00:17<00:08, 3446.22 examples/s]Map:  68%|██████▊   | 60000/87999 [00:17<00:08, 3473.15 examples/s]Map:  69%|██████▉   | 61000/87999 [00:17<00:07, 3484.72 examples/s]Map:  70%|███████   | 62000/87999 [00:18<00:07, 3473.54 examples/s]Map:  72%|███████▏  | 63000/87999 [00:18<00:07, 3483.73 examples/s]Map:  73%|███████▎  | 64000/87999 [00:18<00:06, 3489.44 examples/s]Map:  74%|███████▍  | 65000/87999 [00:19<00:07, 3253.93 examples/s]Map:  75%|███████▌  | 66000/87999 [00:19<00:06, 3321.48 examples/s]Map:  76%|███████▌  | 67000/87999 [00:19<00:06, 3365.41 examples/s]Map:  77%|███████▋  | 68000/87999 [00:19<00:05, 3397.88 examples/s]Map:  78%|███████▊  | 69000/87999 [00:20<00:05, 3428.61 examples/s]Map:  80%|███████▉  | 70000/87999 [00:20<00:05, 3441.88 examples/s]Map:  81%|████████  | 71000/87999 [00:20<00:04, 3448.21 examples/s]Map:  82%|████████▏ | 72000/87999 [00:21<00:04, 3225.14 examples/s]Map:  83%|████████▎ | 73000/87999 [00:21<00:04, 3298.21 examples/s]Map:  84%|████████▍ | 74000/87999 [00:21<00:04, 3342.34 examples/s]Map:  85%|████████▌ | 75000/87999 [00:22<00:03, 3379.68 examples/s]Map:  86%|████████▋ | 76000/87999 [00:22<00:03, 3426.34 examples/s]Map:  88%|████████▊ | 77000/87999 [00:22<00:03, 3433.37 examples/s]Map:  89%|████████▊ | 78000/87999 [00:22<00:02, 3452.31 examples/s]Map:  90%|████████▉ | 79000/87999 [00:23<00:02, 3197.81 examples/s]Map:  91%|█████████ | 80000/87999 [00:23<00:02, 3273.95 examples/s]Map:  92%|█████████▏| 81000/87999 [00:23<00:02, 3346.30 examples/s]Map:  93%|█████████▎| 82000/87999 [00:24<00:01, 3386.03 examples/s]Map:  94%|█████████▍| 83000/87999 [00:24<00:01, 3415.59 examples/s]Map:  95%|█████████▌| 84000/87999 [00:24<00:01, 3086.55 examples/s]Map:  97%|█████████▋| 85000/87999 [00:25<00:00, 3197.29 examples/s]Map:  98%|█████████▊| 86000/87999 [00:25<00:00, 3252.82 examples/s]Map:  99%|█████████▉| 87000/87999 [00:25<00:00, 3309.19 examples/s]Map: 100%|██████████| 87999/87999 [00:25<00:00, 3362.62 examples/s]Map: 100%|██████████| 87999/87999 [00:26<00:00, 3359.28 examples/s]
Map:   0%|          | 0/10749 [00:00<?, ? examples/s]Map:   9%|▉         | 1000/10749 [00:00<00:02, 3261.19 examples/s]Map:  19%|█▊        | 2000/10749 [00:00<00:02, 3279.52 examples/s]Map:  28%|██▊       | 3000/10749 [00:00<00:02, 3296.00 examples/s]Map:  37%|███▋      | 4000/10749 [00:01<00:02, 3366.02 examples/s]Map:  47%|████▋     | 5000/10749 [00:01<00:01, 3414.71 examples/s]Map:  56%|█████▌    | 6000/10749 [00:01<00:01, 3438.02 examples/s]Map:  65%|██████▌   | 7000/10749 [00:02<00:01, 3465.09 examples/s]Map:  74%|███████▍  | 8000/10749 [00:02<00:00, 3468.08 examples/s]Map:  84%|████████▎ | 9000/10749 [00:02<00:00, 3455.16 examples/s]Map:  93%|█████████▎| 10000/10749 [00:02<00:00, 3463.08 examples/s]Map: 100%|██████████| 10749/10749 [00:03<00:00, 3460.25 examples/s]Map: 100%|██████████| 10749/10749 [00:03<00:00, 3338.88 examples/s]
Map:   0%|          | 0/10657 [00:00<?, ? examples/s]Map:   9%|▉         | 1000/10657 [00:00<00:03, 3087.18 examples/s]Map:  19%|█▉        | 2000/10657 [00:00<00:02, 3262.99 examples/s]Map:  28%|██▊       | 3000/10657 [00:00<00:02, 3380.89 examples/s]Map:  38%|███▊      | 4000/10657 [00:01<00:01, 3418.22 examples/s]Map:  47%|████▋     | 5000/10657 [00:01<00:01, 3454.80 examples/s]Map:  56%|█████▋    | 6000/10657 [00:01<00:01, 3476.63 examples/s]Map:  66%|██████▌   | 7000/10657 [00:02<00:01, 3475.89 examples/s]Map:  75%|███████▌  | 8000/10657 [00:02<00:00, 3482.99 examples/s]Map:  84%|████████▍ | 9000/10657 [00:02<00:00, 3456.20 examples/s]Map:  94%|█████████▍| 10000/10657 [00:02<00:00, 3461.13 examples/s]Map: 100%|██████████| 10657/10657 [00:03<00:00, 3470.64 examples/s]Map: 100%|██████████| 10657/10657 [00:03<00:00, 3343.84 examples/s]
/home/rliubk/.local/lib/python3.10/site-packages/peft/tuners/lora/layer.py:1768: UserWarning: fan_in_fan_out is set to False but the target module is `Conv1D`. Setting fan_in_fan_out to True.
  warnings.warn(
Preprocessed dataset: DatasetDict({
    train: Dataset({
        features: ['input_ids', 'attention_mask', 'labels'],
        num_rows: 87999
    })
    validation: Dataset({
        features: ['input_ids', 'attention_mask', 'labels'],
        num_rows: 10749
    })
    test: Dataset({
        features: ['input_ids', 'attention_mask', 'labels'],
        num_rows: 10657
    })
})
Traceback (most recent call last):
  File "/home/rliubk/llm/llm-project/code/llm-gomoku-project/src/trainer.py", line 253, in <module>
    main() 
  File "/home/rliubk/llm/llm-project/code/llm-gomoku-project/src/trainer.py", line 241, in main
    trainer.setup_peft(
  File "/home/rliubk/llm/llm-project/code/llm-gomoku-project/src/trainer.py", line 131, in setup_peft
    modules = [self.model.base_model.model.h[i] for i in range(frozen_layers)]
  File "/home/rliubk/llm/llm-project/code/llm-gomoku-project/src/trainer.py", line 131, in <listcomp>
    modules = [self.model.base_model.model.h[i] for i in range(frozen_layers)]
  File "/home/rliubk/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2LMHeadModel' object has no attribute 'h'
Running: python src/trainer.py --model gpt2-medium --epochs 1 --output_dir models

==================================================
  Training the model
==================================================
Running: python run_no_ds.py --model gpt2-medium --epochs 1 --output_dir models
Traceback (most recent call last):
  File "/home/rliubk/llm/llm-project/code/llm-gomoku-project/run_pipeline.py", line 79, in <module>
    main() 
  File "/home/rliubk/llm/llm-project/code/llm-gomoku-project/run_pipeline.py", line 59, in main
    run_command(
  File "/home/rliubk/llm/llm-project/code/llm-gomoku-project/run_pipeline.py", line 19, in run_command
    result = subprocess.run(command, shell=True, check=True)
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'python run_no_ds.py --model gpt2-medium --epochs 1 --output_dir models' returned non-zero exit status 1.
